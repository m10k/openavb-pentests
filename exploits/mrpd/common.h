#ifndef _COMMON_H
#define _COMMON_H

#define PROTO_MVRP 0x88F5
#define PROTO_MMRP 0x88F6
#define PROTO_MSRP 0x22EA
#define PROTO_MIRP 0x8929

#define MMRP_VER   0

#include <stdlib.h>
#include <stdint.h>

typedef struct mmrp mmrp_t;

typedef struct mrpdu_message {
  uint8_t type;
  uint8_t len;
  uint8_t data[0];
} mrpdu_message_t;

typedef struct mrpdu {
  uint8_t ver;
  mrpdu_message_t msg[];
} mrpdu_t;

int net_socket(int, const char*);
int net_write(int, const void*, const void*, unsigned short, const char*, size_t);
int net_close(int);

mmrp_t* mmrp_new(uint8_t);
void mmrp_free(mmrp_t*);
int mmrp_send(int, const char*, size_t);
int mmrp_msg_append(mmrp_t*, uint8_t, uint8_t, uint16_t);

ssize_t mmrp_raw(mmrp_t*, void*, size_t);

#endif /* _COMMON_H */
